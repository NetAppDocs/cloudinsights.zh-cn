---
sidebar: sidebar 
permalink: task_create_monitor.html 
keywords: performance policy, performance, thresholds, alerts, preference, delete 
summary: 创建监控器，以便针对性能或清单阈值发出警报 
---
= 向监控器发出警报


[role="lead"]
您可以创建监控器来设置触发警报的阈值，以便向您通知与网络中资源相关的问题。例如，您可以创建一个监控器，以便针对任意多种协议发出 _node write latency 警报。


TIP: Cloud Insights 标准版及更高版本提供了监控和警报功能。

达到或超过受监控的阈值和条件时， Cloud Insights 将创建警报。一个监控器可以具有 _Warning_ 阈值， _critical_ 阈值，也可以同时具有这两者。



=== 监控或性能策略？

* 性能策略 * 与 * 监控 * 之间有何区别？

_policies_ 允许您为 " 基础架构 " 对象设置阈值，例如存储， VM ， EC2 和端口。达到或超过阈值时，这些策略将触发违规。可以对每个违规进行调查以进行故障排除。本节其他部分将详细介绍策略 link:task_create_performance_policies.html["文档。"]。

_monitors_ 为 " 集成 " 数据提供类似的功能，例如为 Kubernetes ， ONTAP 高级指标和 Telegraf 插件收集的数据，并在超过阈值时发出警报。使用监控器，您可以为 " 警告 " 或 " 严重 " 级别的警报设置阈值，也可以同时为这两者设置阈值。

策略和监控器位于 * 警报 * 菜单下。

image:AlertsMenuLarger.png["警报菜单"]

触发策略或监控器后，可以发送电子邮件。



=== 创建监控器

在以下示例中，我们将创建一个监控器，以便在 _Volume Node NFS 写入延迟 _ 达到或超过 200 毫秒时发出警告警报，并在达到或超过 400 毫秒时发出严重警报。我们只希望在超过任一阈值至少持续 15 分钟时收到警报。



==== 要求

* 必须配置 Cloud Insights 以收集集成数据，并且正在收集该数据。




==== 创建监控器

. 从 Cloud Insights 菜单中，单击 * 警报 > 管理监控器 *
+
此时将显示监控器列表页面，其中显示了当前配置的监控器。

. 要添加监控器，请单击 * + Monitor* 。要修改现有监控器，请单击列表中的监控器名称。
+
此时将显示 Monitor Configuration 对话框。

. 在下拉列表中，搜索并选择要监控的对象类型和指标，例如 _netapp_ontap_volume_node_nfs_write_latter_ 。


您可以设置筛选器以缩小要监控的对象属性或指标范围。

image:MonitorMetricFilter.png["指标筛选"]

使用集成数据（ Kubernetes ， ONTAP 高级数据等）时，指标筛选会从绘制的数据系列中删除单个 / 不匹配的数据点，而不像基础架构数据（存储， VM ，端口等）那样，基础架构数据（存储， VM ，端口等）中的筛选器会处理数据系列的聚合值，并可能从图表中删除整个对象。


TIP: 要创建多条件监控器（例如， IOPS > X 和延迟 > Y ），请将第一个条件定义为阈值，将第二个条件定义为筛选器。



==== 定义监控器的条件。

. 选择要监控的对象和指标后，设置警告级别和 / 或严重级别阈值。
. 对于 _Warning_ 级别，输入 200 。指示此警告级别的虚线显示在示例图中。
. 对于 _critical_ 级别，输入 400 。指示此严重级别的虚线显示在示例图中。
+
此图显示历史数据。图中的 " 警告 " 和 " 严重 " 级别行是监控器的可视表示，因此您可以轻松查看监控器在每种情况下何时可能触发警报。

. 对于发生时间间隔，请选择 _continuous_ ，持续时间为 _15 分钟。
+
您可以选择在违反阈值时触发警报，或者等待阈值在一段时间内持续违反。在我们的示例中，我们不希望在总 IOPS 峰值高于 " 警告 " 或 " 严重 " 级别时都收到警报，但仅当受监控对象持续超过其中一个级别至少 15 分钟时才会收到警报。

+
image:define_monitor_conditions.png["定义条件"]





=== 设置更正操作或追加信息

您可以通过填写 * 添加警报问题描述 * 部分来添加可选的问题描述以及其他见解和 / 或更正操作。问题描述最多可以包含 1024 个字符，并将随警报一起发送。洞察力 / 更正操作字段最多可包含 67 ， 000 个字符，并将显示在警报登录页面的摘要部分中。

在这些字段中，您可以提供注释，链接或更正警报或以其他方式解决警报的步骤。

image:Monitors_Alert_Description.png["警报更正操作和问题描述"]



=== 选择通知类型和收件人

在 _set up team notification （ s ） _ 部分中，您可以选择是通过电子邮件还是 Webhook 向您的团队发出警报。

image:Webhook_Choose_Monitor_Notification.png["选择警报方法"]

* 通过电子邮件警报： *

指定警报通知的电子邮件收件人。如果需要，您可以为警告或严重警报选择不同的收件人。

image:email_monitor_alerts.png["通过电子邮件发送警报收件人"]

* 通过 Webhook 警报： *

指定警报通知的 webhook 。如果需要，您可以为警告或严重警报选择不同的网络挂钩。

image:Webhook_Monitor_Notifications.png["webhook 警报"]


NOTE: webhooks 被视为预览功能，因此可能会发生更改。



=== 保存您的显示器

. 如果需要，您可以添加监控器的问题描述。
. 为 Monitor 指定一个有意义的名称，然后单击 * 保存 * 。
+
新的监控器将添加到活动监控器列表中。





=== 监控列表

" 监控 " 页面列出了当前配置的监控器，显示以下内容：

* 监控器名称
* 状态
* 正在监控的对象 / 指标
* 监控器的条件


您可以通过单击监控器右侧的菜单并选择 * 暂停 * 来选择临时暂停监控某个对象类型。准备好恢复监控后，单击 * 恢复 * 。

您可以从菜单中选择 * 复制 * 来复制监控器。然后，您可以修改新的监控器并更改对象 / 指标，筛选器，条件，电子邮件收件人等

如果不再需要显示器，您可以从菜单中选择 * 删除 * 来将其删除。



== 监控组和系统定义的监控器

通过分组，您可以查看和管理相关监控器。例如，您可以为环境中的存储配置一个专用监控组，也可以为特定收件人列表配置相关监控器。

image:Monitors_Custom_System.png["监控组列表"]

监控器分为以下几类：

* 所有监控器 * ：用户创建的和系统定义的所有监控器
* * 自定义监控器 * ：包括用户创建的监控器
* * 系统监控组 * ：这些组包括系统定义的监控器，这些监控器基于环境中的数据收集器
* * 用户创建的监控组 * ：这些是您创建的监控组


组名称旁边会显示组中包含的监控器数量。


NOTE: 自定义监控器可以暂停，恢复，删除或移动到其他组。系统定义的监控器可以暂停和恢复，但不能删除或移动。



=== 系统定义的监控器

系统定义的监控器由预定义的指标和条件以及默认说明和更正操作组成，这些内容无法修改。您可以修改系统定义的监控器的通知收件人列表。要查看指标，条件，问题描述和更正操作，或者修改收件人列表，请打开系统定义的监控组，然后单击列表中的监控器名称。

无法修改或删除系统定义的监控组。

以下系统定义的监控器可在所记录的组中使用。

* * ONTAP Infrastructure* 可监控 ONTAP 集群中与基础架构相关的问题。
* * ONTAP 工作负载示例 * 包括与工作负载相关的问题的监控器。
* 两个组中的监控器默认为 _Paused_state 。


|===
| 组 | 监控器名称 | 监控问题描述 


| ONTAP 基础架构 | 存储容量限制 | 当存储池（聚合）填满时， I/O 操作会减慢并最终停止，从而导致存储中断意外事件。警告警报表示应尽快采取计划内的操作来还原最小可用空间。严重警报表示服务即将中断，应采取紧急措施释放空间以确保服务连续性。 


| ONTAP 基础架构 | 存储性能限制 | 当存储池达到性能限制时，操作会减慢，延迟会增加，工作负载和应用程序可能会开始出现故障。ONTAP 会评估因工作负载而导致的存储池利用率，并估计已消耗的性能百分比。警告警报表示应采取计划内操作以减少存储池负载，因为可能没有足够的存储池性能来处理工作负载峰值。严重警报表示性能下降即将发生，应采取紧急措施来减少存储池负载，以确保服务连续性。 


| ONTAP 基础架构 | 光纤通道端口利用率高 | 光纤通道协议端口用于在客户主机系统和 ONTAP LUN 之间接收和传输 SAN 流量。如果端口利用率较高，则会成为瓶颈，并最终影响光纤通道协议工作负载的性能。警告警报表示应采取计划内操作来平衡网络流量。严重警报表示服务即将中断，应采取紧急措施平衡网络流量，以确保服务连续性。 


| ONTAP 基础架构 | 网络端口利用率高 | 网络端口用于在客户主机系统和 ONTAP 卷之间接收和传输 NFS ， CIFS 和 iSCSI 协议流量。如果端口利用率较高，则会成为瓶颈，并最终影响 NFS ， CIFS 和 iSCSI 工作负载的性能。警告警报表示应采取计划内操作来平衡网络流量。严重警报表示服务即将中断，应采取紧急措施平衡网络流量，以确保服务连续性。 


| ONTAP 工作负载示例 | 卷索引节点限制 | 存储文件的卷使用索引节点（索引节点）来存储文件元数据。当卷用尽其索引节点分配时，无法再向其添加文件。警告警报表示应采取计划内操作来增加可用索引节点的数量。严重警报表示文件限制即将耗尽，应采取紧急措施释放索引节点以确保服务连续性。 


| ONTAP 工作负载示例 | qtree 容量已满 | qtree 是一种逻辑上定义的文件系统，可以作为卷中根目录的一个特殊子目录存在。每个 qtree 都有一个默认空间配额或一个配额策略定义的配额，用于在卷容量范围内限制树中存储的数据量。警告警报表示应采取计划内操作来增加空间。严重警报表示服务即将中断，应采取紧急措施释放空间以确保服务连续性。 


| ONTAP 工作负载示例 | LUN 高延迟 | LUN 是指通常由性能敏感型应用程序（如数据库）驱动的 IO 流量的对象。高 LUN 延迟意味着应用程序本身可能会受到影响，无法完成其任务。警告警报表示应采取计划内操作将 LUN 移动到相应的节点或聚合。严重警报表示服务即将中断，应采取紧急措施以确保服务连续性。以下是基于介质类型的预期延迟 - SSD 最长 1-2 毫秒； SAS 最长 8-10 毫秒； SATA HDD 17 至 20 毫秒 


| ONTAP 工作负载示例 | NVMe 命名空间延迟高 | NVMe 命名空间是指通常由性能敏感型应用程序（如数据库）驱动的 IO 流量提供服务的对象。NVMe 命名空间延迟较高意味着应用程序本身可能会受到影响，无法完成其任务。警告警报表示应采取计划内操作将 LUN 移动到相应的节点或聚合。严重警报表示服务即将中断，应采取紧急措施以确保服务连续性。 


| ONTAP 工作负载示例 | qtree 文件软限制 | qtree 是一种逻辑上定义的文件系统，可以作为卷中根目录的一个特殊子目录存在。每个 qtree 都有一个可包含的文件数量配额，以便在卷中保持可管理的文件系统大小。qtree 会保留软文件编号配额，以便能够在达到 qtree 中的文件限制并无法存储任何其他文件之前主动向用户发出警报。监控 qtree 中的文件数量可确保用户获得无中断的数据服务。 


| ONTAP 工作负载示例 | qtree 文件硬限制 | qtree 是一种逻辑上定义的文件系统，可以作为卷中根目录的一个特殊子目录存在。每个 qtree 都有一个可包含的文件数量配额，以便在卷中保持可管理的文件系统大小。qtree 会保留硬文件编号配额，超过此配额，树中的新文件将被拒绝。监控 qtree 中的文件数量可确保用户获得无中断的数据服务。 


| ONTAP 工作负载示例 | qtree 容量软限制 | qtree 是一种逻辑上定义的文件系统，可以作为卷中根目录的一个特殊子目录存在。每个 qtree 都有一个以 KB 为单位的空间配额，可用于存储数据，以控制卷中用户数据的增长，并且不超过其总容量。qtree 保持软存储容量配额，以便能够在达到 qtree 中的总容量配额限制并无法再存储数据之前主动向用户发出警报。监控 qtree 中存储的数据量可确保用户接收到无中断的数据服务。 


| ONTAP 工作负载示例 | qtree 容量硬限制 | qtree 是一种逻辑上定义的文件系统，可以作为卷中根目录的一个特殊子目录存在。每个 qtree 都有一个以 KB 为单位的空间配额，可用于存储数据，以控制卷中用户数据的增长，并且不超过其总容量。qtree 硬存储容量配额用作一个阈值，超过此阈值后，将拒绝对 qtree 进行写入。监控 qtree 中存储的数据量可确保用户接收到无中断的数据服务。 


| ONTAP 工作负载示例 | 用户配额容量软限制 | ONTAP 可识别有权访问卷中的卷，文件或目录的 Unix 或 Windows 系统的用户。因此， ONTAP 允许客户为其 Linux 或 Windows 系统的用户或用户组配置存储容量。用户或组策略配额用于限制用户可用于其自己数据的空间量。此配额的软限制允许在卷中已用容量达到总容量配额时主动通知用户。监控用户配额或组配额中存储的数据量可确保用户获得不间断的数据服务。 


| ONTAP 工作负载示例 | 用户配额容量硬限制 | ONTAP 可识别有权访问卷中的卷，文件或目录的 Unix 或 Windows 系统的用户。因此， ONTAP 允许客户为其 Linux 或 Windows 系统的用户或用户组配置存储容量。用户或组策略配额用于限制用户可用于其自己数据的空间量。此配额的硬限制允许在达到总容量配额之前，当卷中已用容量正确时向用户发出通知。监控用户配额或组配额中存储的数据量可确保用户获得不间断的数据服务。 


| ONTAP 工作负载示例 | 卷高延迟 | 卷是指通常由性能敏感型应用程序（包括 DevOps 应用程序，主目录和数据库）驱动的 IO 流量提供服务的对象。高卷延迟意味着应用程序本身可能会受到影响，无法完成其任务。监控卷延迟对于保持应用程序一致的性能至关重要。以下是基于介质类型的预期延迟 - SSD 最长 1-2 毫秒； SAS 最长 8-10 毫秒； SATA HDD 17 至 20 毫秒 


| ONTAP 工作负载示例 | Snapshot 预留容量已满 | 存储应用程序和客户数据需要卷的存储容量。其中一部分空间称为 Snapshot 预留空间，用于存储快照，以便在本地保护数据。ONTAP 卷中存储的新数据和更新数据越多，快照容量就越多，未来的新数据或更新数据可用的快照存储容量也就越少。如果卷中的快照数据容量达到总快照预留空间，可能会导致客户无法存储新的快照数据，并降低卷中数据的保护级别。监控卷已用快照容量可确保数据服务的连续性。 


| ONTAP 工作负载示例 | 卷容量已满 | 存储应用程序和客户数据需要卷的存储容量。ONTAP 卷中存储的数据越多，未来数据的存储可用性就越低。如果卷中的数据存储容量达到总存储容量，则可能会导致客户由于缺少存储容量而无法存储数据。监控卷已用存储容量可确保数据服务的连续性。 
|===


=== 自定义监控组

要创建新的自定义监控组，请单击 * "+" 创建新监控组 * 按钮。输入组的名称，然后单击 * 创建组 * 。此时将创建一个具有此名称的空组。

要向组中添加监控器，请转到 _all monitors_ 组（建议）并执行以下操作之一：

* 要添加单个显示器，请单击该显示器右侧的菜单，然后选择 _Add to Group_ 。选择要将监控器添加到的组。
* 单击监控器名称以打开监控器的编辑视图，然后在 _Associate to a monitor group_ 部分中选择一个组。
+
image:Monitors_AssociateToGroup.png["与组关联"]



通过单击某个组并从菜单中选择 _Remove from Group_ 来删除监控器。您不能从 _all monitors_ 或 _Custom Monitors_ 组中删除监控器。要从这些组中删除监控器，必须删除该监控器本身。


NOTE: 从组中删除监控器不会从 Cloud Insights 中删除该监控器。要完全删除某个监控器，请选择该监控器，然后单击 _Delete_ 。此操作还会将其从所属组中删除，并且任何用户都无法再使用它。

您也可以按相同方式将显示器移动到其他组，选择 _move to Group_ 。


NOTE: 在任何给定时间，每个监控器只能属于一个组。

要一次性暂停或恢复组中的所有监视器，请选择该组的菜单，然后单击 _Pause_ 或 _Resume_ 。

使用同一菜单重命名或删除组。删除组不会从 Cloud Insights 中删除这些监控器；它们在 _all monitors_中 仍然可用。

image:Monitors_PauseGroup.png["暂停组"]



=== 更多信息

* link:task_view_and_manage_alerts.html["查看和忽略警报"]

